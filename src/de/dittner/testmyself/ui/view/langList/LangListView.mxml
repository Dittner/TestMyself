<?xml version="1.0"?>
<view:SmartView xmlns:fx="http://ns.adobe.com/mxml/2009"
                xmlns:view="de.dittner.testmyself.ui.common.view.*"
                xmlns:components="de.dittner.testmyself.ui.view.langList.components.*"
                xmlns:tile="de.dittner.testmyself.ui.common.tile.*"
                xmlns:s="library://ns.adobe.com/flex/spark"
                isBgShown="false">

    <fx:Script><![CDATA[
        import de.dittner.async.IAsyncOperation;
        import de.dittner.testmyself.backend.utils.AddEnglishWordsToDBFromFileCmd;
        import de.dittner.testmyself.model.domain.language.LanguageID;
        import de.dittner.testmyself.ui.common.tile.TileID;
        import de.dittner.testmyself.ui.common.utils.AppColors;
        import de.dittner.testmyself.ui.common.view.ViewModelFactory;
        import de.dittner.testmyself.utils.Values;

        [Bindable]
        public var vm:LangListVM;

        override protected function activating():void {
            vm = ViewModelFactory.instance.langListVM;
            vm.lockView();
        }

        override protected function activate():void {
            navigationMenu.hide();
            toolbar.hide();
            actionMenu.hide();
            vm.unlockView();
            vm.viewActivated(viewInfo);

            var appDescriptor:XML = NativeApplication.nativeApplication.applicationDescriptor;
            var ns:Namespace = appDescriptor.namespace();
            var appVersion:String = appDescriptor.ns::versionNumber;
            versionLbl.text = "v. " + appVersion;
        }

        /*private var addEnglishWordsCmd:AddEnglishWordsToDBFromFileCmd;
        private function addEnglishWords():void {
            if (!addEnglishWordsCmd) {
                addEnglishWordsCmd = new AddEnglishWordsToDBFromFileCmd(vm.appModel.storage, vm.appModel.enLang);
                //addEnglishWordsCmd = new FillDBWithWordsFromEnglishRussianDictionaryCmd();
                addEnglishWordsCmd.addProgressCallback(progressHandler);
                addEnglishWordsCmd.addCompleteCallback(addEnglishWordsComplete);
                addEnglishWordsCmd.execute();
            }
        }*/

        private function progressHandler(value:Number):void {
            /*if (value < 1) {
                info.text = Math.floor(value * 100) + "%";
                if (addEnglishWordsCmd.curNote)
                    info.text += "\n" + addEnglishWordsCmd.curNote.title;
            }*/
        }

        private function addEnglishWordsComplete(op:IAsyncOperation):void {
            //info.text = "100%";
        }

        override protected function deactivate():void {
            vm.viewDeactivated();
        }
        ]]></fx:Script>

    <!--<s:Button label="Add English words"
              click="addEnglishWords()"
              horizontalCenter="0" top="10"/>

    <s:Label id="info"
             left="20" right="20" top="50" textAlign="center"
             fontSize="20" color="#FFFF00"/>-->

    <components:LanguageInfoBoard id="deInfoBoard"
                                  localeInfo="de_DE"
                                  mouseEnabled="false" mouseChildren="false"
                                  wordVocabularyInfo="{vm.deWordVocabularyInfo}"
                                  verbVocabularyInfo="{vm.deVerbVocabularyInfo}"
                                  lessonVocabularyInfo="{vm.deLessonVocabularyInfo}"
                                  verticalCenter="0" horizontalCenter="{-Values.PT200}"/>

    <tile:FadeTileButton title="Deutsch"
                         use9Scale="true"
                         iconTileID="{TileID.FLAG_GERMANY}"
                         upTileID="{TileID.BTN_LANG_UP}"
                         downTileID="{TileID.BTN_LANG_DOWN}"
                         horizontalCenter="{-Values.PT200}"
                         width="{Values.PT300}"
                         verticalCenter="{Values.PT200}"
                         paddingLeft="{Values.PT10}"
                         textColor="#ffFFff"
                         fontSize="{Values.PT30}"
                         click="vm.selectLang(LanguageID.DE)"/>

    <components:LanguageInfoBoard id="enInfoBoard"
                                  localeInfo="en_US"
                                  mouseEnabled="false" mouseChildren="false"
                                  wordVocabularyInfo="{vm.enWordVocabularyInfo}"
                                  verbVocabularyInfo="{vm.enVerbVocabularyInfo}"
                                  lessonVocabularyInfo="{vm.enLessonVocabularyInfo}"
                                  verticalCenter="0" horizontalCenter="{Values.PT200}"/>

    <tile:FadeTileButton title="English"
                         use9Scale="true"
                         iconTileID="{TileID.FLAG_GB}"
                         upTileID="{TileID.BTN_LANG_UP}"
                         downTileID="{TileID.BTN_LANG_DOWN}"
                         horizontalCenter="{Values.PT200}"
                         width="{Values.PT300}"
                         verticalCenter="{Values.PT200}"
                         paddingLeft="{Values.PT10}"
                         textColor="#ffFFff"
                         fontSize="{Values.PT30}"
                         click="vm.selectLang(LanguageID.EN)"/>

    <s:Label id="versionLbl"
             width="100%" textAlign="center"
             fontSize="{Values.PT15}" bottom="{Values.PT5}"
             fontWeight="bold"
             color="{AppColors.WHITE}"/>
</view:SmartView>

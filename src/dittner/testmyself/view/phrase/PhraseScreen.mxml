<?xml version="1.0"?>
<core:ScreenBase xmlns:fx="http://ns.adobe.com/mxml/2009"
                 xmlns:s="library://ns.adobe.com/flex/spark"
                 xmlns:core="dittner.testmyself.view.common.screen.*"
                 xmlns:list="dittner.testmyself.view.phrase.list.*"
                 xmlns:toolbar="dittner.testmyself.view.phrase.toolbar.*"
                 xmlns:editor="dittner.testmyself.view.phrase.form.*"
                 xmlns:mp3="dittner.testmyself.view.common.audio.mp3.*"
                 xmlns:filter="dittner.testmyself.view.common.filter.*"
                 xmlns:navigation="dittner.testmyself.view.common.pagination.*"
                 currentState="inactive"
                 horizontalCenter="0">

    <fx:Script><![CDATA[
        import dittner.testmyself.view.common.utils.AppColors;
        import dittner.testmyself.view.common.utils.AppSizes;
        import dittner.testmyself.view.common.utils.Fonts;

        //----------------------------------------------------------------------------------------------
        //
        //  Methods
        //
        //----------------------------------------------------------------------------------------------

        public function activate():void {
            if (currentState == "inactive") setCurrentState("normal");
        }

        public function showEditor():void {
            setCurrentState("edit");
        }

        public function hideEditor():void {
            setCurrentState("normal");
        }

        override protected function updateDisplayList(w:Number, h:Number):void {
            super.updateDisplayList(w, h);
            if (form) {
                form.width = Math.min(w, AppSizes.EDITOR_MAX_WIDTH);
                form.x = w - form.width;
            }
        }
        ]]></fx:Script>

    <core:states>
        <s:State name="disabled"/>
        <s:State name="inactive"/>
        <s:State name="normal"/>
        <s:State name="edit"/>
    </core:states>

    <!--content bg-->
    <s:Rect width="100%" height="100%">
        <s:fill>
            <s:BitmapFill source="@Embed(source='/assets/screen/screen_bg_pattern.png')"
                          fillMode="repeat"/>
        </s:fill>
    </s:Rect>

    <!--header bg-->
    <s:Rect width="100%" height="{HEADER_HEI}">
        <s:fill>
            <s:SolidColor color="{AppColors.SCREEN_HEADER_BG}"/>
        </s:fill>
    </s:Rect>

    <s:HGroup width="100%" height="{HEADER_HEI}"
              verticalAlign="middle"
              paddingLeft="{PADDING}" paddingRight="{PADDING}">

        <s:Label text="{title}"
                 fontFamily="{Fonts.ROBOTO}"
                 fontSize="16"
                 paddingTop="2"
                 width="100%"
                 color="#54545d"/>

        <toolbar:PhraseToolbar id="toolbar"
                               excludeFrom="inactive"
                               width="100%"
                               height="{HEADER_HEI}"/>
    </s:HGroup>

    <s:Scroller left="-1" right="-1" top="{HEADER_HEI}" bottom="{FOOTER_HEI}"
                excludeFrom="inactive"
                minViewportInset="1"
                hasFocusableChildren="false">
        <s:Group width="100%">
            <list:TransUnitList id="list"
                                width="100%"
                                contentBackgroundAlpha="0"
                                itemRenderer="dittner.testmyself.view.phrase.common.PhraseRenderer">
                <list:layout>
                    <s:VerticalLayout gap="0" useVirtualLayout="false"/>
                </list:layout>
            </list:TransUnitList>
        </s:Group>

    </s:Scroller>

    <!--footer-->
    <s:Group width="100%" height="{FOOTER_HEI}" bottom="0"
             excludeFrom="inactive">
        <s:Rect width="100%" bottom="0" height="100%">
            <s:fill>
                <s:SolidColor color="{AppColors.SCREEN_HEADER_BG}"/>
            </s:fill>
        </s:Rect>


        <mp3:MP3Player id="player"
                       width="400"
                       left="{PADDING - 10}"
                       verticalCenter="0"
                       removeRecordEnabled="false"
                       audioComment="{list.selectedItem.audio}"
                       skinClass="dittner.testmyself.view.common.audio.skins.MP3PlayerSkin"/>

        <navigation:PaginationBar id="paginationBar"
                                  left="{PADDING}" right="{PADDING}"
                                  height="100%"/>

    </s:Group>


    <s:Group width="100%" height="100%"
             excludeFrom="inactive"
             visible="false" visible.edit="true"
             mouseEnabled.edit="true" mouseEnabled="false">
        <s:Rect width="100%" height="100%">
            <s:fill>
                <s:SolidColor color="{AppColors.EDITOR_SHADOW}" alpha=".5"/>
            </s:fill>
        </s:Rect>

        <editor:PhraseForm id="form"
                           visible="false"
                           bottom="0"
                           top="{HEADER_HEI}"/>

        <filter:ThemeFilter id="filter"
                            width="350"
                            visible="false"
                            right="0"
                            bottom="0"
                            top="{HEADER_HEI}"/>
    </s:Group>

</core:ScreenBase>
